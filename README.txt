TODO: add a compaction process to remove duplicates in the database.
TODO: keep track of the inputs and outputs already added to the graph.
